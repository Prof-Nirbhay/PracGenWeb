<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>PracGenWeb</title>

<style>
body{
    font-family:"Times New Roman", Times, serif;
    background:#eef1f5;
    margin:0;
    padding:0;
}

.container{
    max-width:900px;
    margin:30px auto;
    background:#fff;
    padding:25px;
    border-radius:8px;
    box-shadow:0 4px 12px rgba(0,0,0,0.15);
}

.hidden{
    display:none;
}

.center-box{
    text-align:center;
    padding:40px;
}

button{
    padding:10px 20px;
    font-size:12pt;
    border:none;
    border-radius:4px;
    cursor:pointer;
    background:#1f4fd8;
    color:#fff;
    margin:10px;
}

button:hover{
    background:#163bb3;
}

label{
    font-weight:bold;
    display:block;
    margin-top:10px;
}

input, textarea, select{
    width:100%;
    padding:6px;
    font-family:"Times New Roman";
    font-size:12pt;
    margin-top:4px;
}
</style>
</head>

<body>

<!-- ================= INTRO PAGE ================= -->

<div class="container" id="introPage">
    <div class="center-box">
        <h2>Practical Exam Question Paper Generator</h2>
        <h3>Select Combination Type</h3>

        <button onclick="startGenerator('same')">
            Easy × Easy Combination
        </button>

        <button onclick="startGenerator('mixed')">
            Easy × Difficult Combination
        </button>
    </div>
</div>

<!-- ================= MAIN GENERATOR ================= -->

<div class="container hidden" id="mainPage">

<h2>DEPARTMENT OF ADVANCED COMPUTING</h2>

<label>Class:</label>
<select id="class">
<option>FYBSc CS AIML</option>
<option>SYBSc CS AIML</option>
<option>TYBSc CS AIML</option>
<option>SYBSc IT</option>
<option>FYBSc IT</option>
</select>

<label>Semester:</label>
<select id="semester">
<option>I</option><option>II</option>
<option>III</option><option>IV</option>
<option>V</option><option>VI</option>
</select>

<label>Subject Name:</label>
<input type="text" id="subject">

<!-- SAME DIFFICULTY -->
<div id="sameBox" class="hidden">
<label>Questions (All Same Level)</label>
<textarea id="sameQuestions" rows="8"></textarea>
</div>

<!-- MIXED -->
<div id="mixedBox" class="hidden">
<label>Easy Questions</label>
<textarea id="easyQuestions" rows="5"></textarea>

<label>Difficult Questions</label>
<textarea id="difficultQuestions" rows="5"></textarea>
</div>

<br>
<button onclick="openPreview()">Preview</button>
<button onclick="downloadWord()">Download Word</button>
<button onclick="goBack()">Back</button>

</div>

<script>

let mode = "";

/* ================= INTRO CONTROL ================= */

function startGenerator(type){
    mode = type;
    document.getElementById("introPage").classList.add("hidden");
    document.getElementById("mainPage").classList.remove("hidden");

    if(type === "same"){
        document.getElementById("sameBox").classList.remove("hidden");
    }else{
        document.getElementById("mixedBox").classList.remove("hidden");
    }
}

function goBack(){
    location.reload();
}

/* ================= TAB SUPPORT ================= */

function enableTab(id){
    document.addEventListener("keydown", function(e){
        if(e.target.id === id && e.key === "Tab"){
            e.preventDefault();
            const start = e.target.selectionStart;
            const end = e.target.selectionEnd;
            e.target.value =
                e.target.value.substring(0,start) + "\t" +
                e.target.value.substring(end);
            e.target.selectionStart =
            e.target.selectionEnd = start + 1;
        }
    });
}

enableTab("sameQuestions");
enableTab("easyQuestions");
enableTab("difficultQuestions");

/* ================= PARSE FUNCTION ================= */

function parseQuestions(textareaId){
    const rawLines = document.getElementById(textareaId).value
        .split(/\r?\n/)
        .filter(line => line.trim() !== "");

    let qs = [];
    let current = null;

    rawLines.forEach(line => {
        if(line.startsWith("\t")){
            if(current){
                current.sub.push(line.trim());
            }
        } else {
            if(current) qs.push(current);
            current = { main: line.trim(), sub: [] };
        }
    });

    if(current) qs.push(current);

    return qs;
}

/* ================= BUILD HTML ================= */

function buildHTML(){

    const cls = document.getElementById("class").value;
    const sem = document.getElementById("semester").value;
    const subject = document.getElementById("subject").value.trim();

    let html = `<html><body style="font-family:'Times New Roman'; font-weight:bold;">`;

    if(mode === "same"){

        const qs = parseQuestions("sameQuestions");

        for(let i=0;i<qs.length;i++){
            for(let j=i+1;j<qs.length;j++){

                html += generatePaper(cls,sem,subject,qs[i],qs[j]);
            }
        }

    }else{

        const easy = parseQuestions("easyQuestions");
        const difficult = parseQuestions("difficultQuestions");

        for(let i=0;i<easy.length;i++){
            for(let j=0;j<difficult.length;j++){

                html += generatePaper(cls,sem,subject,easy[i],difficult[j]);
            }
        }
    }

    html += `</body></html>`;
    return html;
}

/* ================= PAPER TEMPLATE ================= */

function generatePaper(cls,sem,subject,q1,q2){

return `
<table width="100%" cellpadding="6">

<tr>
<td colspan="3" align="center">
<b>
NAGINDAS KHANDWALA COLLEGE, MALAD(W)<br>
${cls} SEM ${sem} PRACTICAL EXAMINATION 2026
</b>
</td>
</tr>

<tr>
<td><b>Q1</b></td>
<td>${q1.main}
${q1.sub.map((s,i)=>`<div style="margin-left:25px;">(${String.fromCharCode(97+i)}) ${s}</div>`).join("")}
</td>
<td><b>20</b></td>
</tr>

<tr>
<td><b>Q2</b></td>
<td>${q2.main}
${q2.sub.map((s,i)=>`<div style="margin-left:25px;">(${String.fromCharCode(97+i)}) ${s}</div>`).join("")}
</td>
<td><b>20</b></td>
</tr>

<tr><td><b>Q3</b></td><td>VIVA</td><td><b>05</b></td></tr>
<tr><td><b>Q4</b></td><td>JOURNAL</td><td><b>05</b></td></tr>

</table>
<br><br>
`;
}

/* ================= OUTPUT ================= */

function openPreview(){
    const html = buildHTML();
    const w = window.open("");
    w.document.write(html);
    w.document.close();
}

function downloadWord(){
    const html = buildHTML();
    const blob = new Blob([html], {type:"text/html"});
    const a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = document.getElementById("subject").value + ".doc";
    a.click();
}

</script>

</body>
</html>
